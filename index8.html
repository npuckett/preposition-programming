<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>P5.js Preposition Examples</title>
    <link rel="stylesheet" href="styles.css">
    <style>
        /* Enhanced iframe fixes for proper sizing and scrolling */
        .frame-container {
            flex: 1;
            background: #f8f8f8;
            position: relative;
            overflow: auto; /* Allow scrolling on desktop */
            min-height: 0; /* Important for flex child */
            -webkit-overflow-scrolling: touch; /* Smooth scrolling on iOS */
        }

        iframe {
            width: 100%;
            height: 100%;
            border: none;
            overflow: auto;
            display: block;
            /* Ensure iframe can handle touch events */
            touch-action: auto;
        }

        /* Ensure proper height calculation */
        .index-container {
            height: 100vh;
            display: flex;
        }

        .content {
            flex: 1;
            display: flex;
            flex-direction: column;
            min-height: 0; /* Important for flex child */
        }

        /* Mobile menu toggle button */
        .mobile-menu-toggle {
            display: none;
            position: fixed;
            top: 15px;
            left: 15px;
            z-index: 1001;
            background: #4CAF50;
            color: white;
            border: none;
            padding: 10px 12px;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }

        .mobile-menu-toggle:hover {
            background: #45a049;
        }

        /* Mobile specific fixes */
        @media (max-width: 768px) {
            .mobile-menu-toggle {
                display: block;
            }

            .sidebar {
                position: fixed;
                top: 0;
                left: 0;
                width: 280px;
                height: 100vh;
                z-index: 1000;
                transform: translateX(-100%);
                transition: transform 0.3s ease;
                box-shadow: 2px 0 5px rgba(0,0,0,0.1);
            }

            .sidebar.open {
                transform: translateX(0);
            }

            .content {
                margin-left: 0;
                width: 100%;
            }

            .content-header {
                padding-left: 60px; /* Make room for menu button */
            }

            .frame-container {
                /* Critical mobile scrolling fixes */
                overflow: auto;
                -webkit-overflow-scrolling: touch;
                /* Ensure proper height for mobile */
                height: calc(100vh - 60px); /* Account for header */
                position: relative;
            }
            
            iframe {
                /* Mobile iframe optimizations */
                min-height: calc(100vh - 60px);
                height: auto;
                /* Enable proper touch handling */
                touch-action: manipulation;
                /* Prevent iframe zoom but allow scroll and touch */
                overflow: scroll;
                -webkit-overflow-scrolling: touch;
            }

            /* Overlay when menu is open */
            .sidebar-overlay {
                display: none;
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0,0,0,0.5);
                z-index: 999;
            }

            .sidebar-overlay.active {
                display: block;
            }
        }

        @media (max-width: 480px) {
            .sidebar {
                width: 100%;
            }

            .content-header h2 {
                font-size: 16px;
            }
        }
    </style>
</head>
<body class="index-body">
    <div class="index-container">
        <!-- Mobile menu toggle button -->
        <button class="mobile-menu-toggle" onclick="toggleMobileMenu()">☰</button>
        
        <!-- Sidebar overlay for mobile -->
        <div class="sidebar-overlay" id="sidebarOverlay" onclick="closeMobileMenu()"></div>
        
        <div class="sidebar" id="sidebar">
            <div class="header">
                <h1>P5.js Prepositions</h1>
                <p>Methods for converting language to code</p>
            </div>

            <div class="menu-group">
                <div class="group-title">Spatial Relationships</div>
                <button class="menu-item" onclick="loadExample('preposition-above.html', 'Above', this)">Above</button>
                <button class="menu-item" onclick="loadExample('preposition-below.html', 'Below', this)">Below</button>
                <button class="menu-item" onclick="loadExample('preposition-between.html', 'Between', this)">Between</button>
                <button class="menu-item" onclick="loadExample('preposition-among.html', 'Among', this)">Among</button>
                <button class="menu-item" onclick="loadExample('preposition-beside.html', 'Beside', this)">Beside</button>
                <button class="menu-item" onclick="loadExample('preposition-behind.html', 'Behind', this)">Behind</button>
                <button class="menu-item" onclick="loadExample('preposition-beneath.html', 'Beneath', this)">Beneath</button>
                <button class="menu-item" onclick="loadExample('preposition-within.html', 'Within', this)">Within</button>
                <button class="menu-item" onclick="loadExample('preposition-through.html', 'Through', this)">Through</button>
            </div>            <div class="menu-group">
                <div class="group-title">Movement & Direction</div>
                <button class="menu-item" onclick="loadExample('preposition-toward.html', 'Toward', this)">Toward</button>
                <button class="menu-item" onclick="loadExample('preposition-away.html', 'Away', this)">Away</button>
                <button class="menu-item" onclick="loadExample('preposition-across.html', 'Across', this)">Across</button>
                <button class="menu-item" onclick="loadExample('preposition-along.html', 'Along', this)">Along</button>
                <button class="menu-item" onclick="loadExample('preposition-around.html', 'Around', this)">Around</button>
                <button class="menu-item" onclick="loadExample('preposition-into.html', 'Into', this)">Into</button>
                <button class="menu-item" onclick="loadExample('preposition-onto.html', 'Onto', this)">Onto</button>
                <button class="menu-item" onclick="loadExample('preposition-past.html', 'Past', this)">Past</button>
                <button class="menu-item" onclick="loadExample('preposition-over.html', 'Over', this)">Over</button>
                <button class="menu-item" onclick="loadExample('preposition-under.html', 'Under', this)">Under</button>
            </div>

            <div class="menu-group">
                <div class="group-title">Time-based</div>
                <button class="menu-item" onclick="loadExample('preposition-before.html', 'Before', this)">Before</button>
                <button class="menu-item" onclick="loadExample('preposition-after.html', 'After', this)">After</button>
                <button class="menu-item" onclick="loadExample('preposition-during.html', 'During', this)">During</button>
                <button class="menu-item" onclick="loadExample('preposition-since.html', 'Since', this)">Since</button>
                <button class="menu-item" onclick="loadExample('preposition-until.html', 'Until', this)">Until</button>
            </div>
        </div>

        <div class="content">
            <div class="content-header">
                <h2 id="current-title">Welcome</h2>
            </div>
            <div class="frame-container">
                <div class="welcome-message" id="welcome-message">
                    <div class="welcome-content">
                        <h3>Welcome to P5.js Prepositions</h3>
                        <p>This collection contains interactive examples showing how spatial, directional, and temporal prepositions can be translated into P5.js sketches.</p>
                        <p>Select a preposition from the menu to explore its interactive example.</p>                        <p><strong>24 examples total:</strong></p>
                        <p>• 9 Spatial Relationships<br>• 10 Movement & Direction<br>• 5 Time-based</p>
                    </div>
                </div>
                <iframe id="content-frame" style="display: none;"></iframe>
            </div>
        </div>
    </div>

    <script>
        function toggleMobileMenu() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebarOverlay');
            
            sidebar.classList.toggle('open');
            overlay.classList.toggle('active');
        }

        function closeMobileMenu() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebarOverlay');
            
            sidebar.classList.remove('open');
            overlay.classList.remove('active');
        }

        function loadExample(filename, title, buttonElement) {
            // Remove active class from all menu items
            const menuItems = document.querySelectorAll('.menu-item');
            menuItems.forEach(item => item.classList.remove('active'));
            
            // Add active class to clicked item
            buttonElement.classList.add('active');
            
            // Update title
            document.getElementById('current-title').textContent = 'Preposition: ' + title;
            
            // Close mobile menu after selection
            closeMobileMenu();
            
            // Hide welcome message and show iframe
            document.getElementById('welcome-message').style.display = 'none';
            const iframe = document.getElementById('content-frame');
            iframe.style.display = 'block';
            
            // Add cache-busting parameter and load content
            iframe.src = filename + '?t=' + Date.now();
            
            // Handle iframe load events
            iframe.onload = function() {
                console.log('Iframe loaded successfully:', filename);
                
                // Enhanced mobile scrolling optimization
                try {
                    const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
                    if (iframeDoc) {
                        // Ensure body and html can scroll properly
                        iframeDoc.body.style.overflow = 'auto';
                        iframeDoc.documentElement.style.overflow = 'auto';
                        
                        // Enable smooth scrolling on iOS
                        iframeDoc.body.style.webkitOverflowScrolling = 'touch';
                        
                        // Optimize container heights for mobile scrolling
                        const containers = iframeDoc.querySelectorAll('.container, .canvas-container');
                        containers.forEach(container => {
                            container.style.minHeight = 'auto';
                            container.style.overflow = 'visible';
                        });
                        
                        // Ensure canvas areas don't interfere with scrolling
                        const canvases = iframeDoc.querySelectorAll('canvas');
                        canvases.forEach(canvas => {
                            // Preserve touch events for P5.js while allowing surrounding scroll
                            canvas.style.touchAction = 'none'; // P5.js handles canvas touches
                        });
                        
                        // Mobile-specific optimizations
                        if (window.innerWidth <= 768) {
                            // Ensure body height is appropriate for content
                            iframeDoc.body.style.minHeight = '100vh';
                            
                            // Add mobile-friendly spacing
                            const descriptions = iframeDoc.querySelectorAll('.description');
                            descriptions.forEach(desc => {
                                desc.style.padding = '15px';
                                desc.style.lineHeight = '1.6';
                            });
                            
                            // Ensure canvas containers have proper mobile spacing
                            const canvasContainers = iframeDoc.querySelectorAll('.canvas-container');
                            canvasContainers.forEach(container => {
                                container.style.margin = '20px 0';
                                container.style.textAlign = 'center';
                            });
                        }
                        
                        console.log('Iframe content optimized for mobile scrolling and touch');
                    }
                } catch (e) {
                    console.log('Cross-origin iframe - cannot modify content directly');
                    
                    // Fallback: Ensure iframe itself can scroll properly
                    iframe.style.overflow = 'auto';
                    iframe.style.webkitOverflowScrolling = 'touch';
                }
                
                // Force iframe to recalculate height on mobile
                if (window.innerWidth <= 768) {
                    setTimeout(() => {
                        iframe.style.height = 'auto';
                        iframe.style.minHeight = 'calc(100vh - 60px)';
                    }, 100);
                }
            };
            
            iframe.onerror = function() {
                console.error('Error loading iframe content:', filename);
                alert('Error loading the example. Please check if the file exists.');
            };
        }

        function returnToWelcome() {
            // Close mobile menu
            closeMobileMenu();
            
            // Return to welcome screen
            const menuItems = document.querySelectorAll('.menu-item');
            menuItems.forEach(item => item.classList.remove('active'));
            
            document.getElementById('current-title').textContent = 'Welcome';
            document.getElementById('welcome-message').style.display = 'flex';
            const iframe = document.getElementById('content-frame');
            iframe.style.display = 'none';
            iframe.src = ''; // Clear iframe content
        }

        // Add keyboard navigation
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                returnToWelcome();
            }
        });

        // Handle window resize
        window.addEventListener('resize', function() {
            // Close mobile menu on desktop resize
            if (window.innerWidth > 768) {
                closeMobileMenu();
            }
            
            // Handle iframe dimensions
            const iframe = document.getElementById('content-frame');
            if (iframe.style.display === 'block') {
                // Force iframe to recalculate its dimensions
                iframe.style.height = '99%';
                setTimeout(() => {
                    iframe.style.height = '100%';
                }, 50);
            }
        });

        // Initialize
        console.log('Index6 initialized with mobile menu support');
    </script>
</body>
</html>
